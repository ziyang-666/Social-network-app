(this["webpackJsonparound-web"]=this["webpackJsonparound-web"]||[]).push([[0],{203:function(e,t,a){},396:function(e,t,a){"use strict";a.r(t);var s=a(5),n=a(0),r=a(20),o=a.n(r),c=(a(203),a(50)),i=a.p+"static/media/logo.6ce24c58.svg",l=a(406);var d=function(e){var t=e.isLoggedIn,a=e.handleLogout;return Object(s.jsxs)("header",{className:"App-header",children:[Object(s.jsx)("img",{src:i,className:"App-logo",alt:"logo"}),Object(s.jsx)("span",{className:"App-title",children:"Around Web"}),t?Object(s.jsx)(l.a,{className:"logout",onClick:a}):null]})},u=a(19),j=a(195),b=a(402),m=a(404),h=a(54),p=a(407),g=a(408),O=a(106),f=a(58),x=a.n(f),v="token",y="https://around-311020.wl.r.appspot.com",w=0,S=1,P=2;var k=function(e){var t=e.handleLoggedIn;return Object(s.jsxs)(b.a,{name:"normal_login",className:"login-form",onFinish:function(e){var a=e.username,s=e.password,n={method:"POST",url:"".concat(y,"/signin"),data:{username:a,password:s},headers:{"Content-Type":"application/json"}};x()(n).then((function(e){if(200===e.status){var a=e.data;t(a),j.b.success("Login succeed! ")}})).catch((function(e){console.log("login failed: ",e.message),j.b.error("Login failed!")}))},children:[Object(s.jsx)(b.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"}],children:Object(s.jsx)(m.a,{prefix:Object(s.jsx)(p.a,{className:"site-form-item-icon"}),placeholder:"Username"})}),Object(s.jsx)(b.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(s.jsx)(m.a,{prefix:Object(s.jsx)(g.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})}),Object(s.jsxs)(b.a.Item,{children:[Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"Log in"}),"Or ",Object(s.jsx)(O.b,{to:"/register",children:"register now!"})]})]})},C=a(51),I={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},N={wrapperCol:{xs:{span:16,offset:0},sm:{span:16,offset:8}}};var L=function(e){var t=b.a.useForm(),a=Object(c.a)(t,1)[0];return Object(s.jsxs)(b.a,Object(C.a)(Object(C.a)({},I),{},{form:a,name:"register",onFinish:function(t){console.log("Received values of form: ",t);var a=t.username,s=t.password,n={method:"POST",url:"".concat(y,"/signup"),data:{username:a,password:s},headers:{"content-type":"application/json"}};x()(n).then((function(t){console.log(t),200===t.status&&(j.b.success("Registration succeed!"),e.history.push("/login"))})).catch((function(e){console.log("register failed: ",e.message),j.b.error("Registration failed!")}))},className:"register",children:[Object(s.jsx)(b.a.Item,{name:"username",label:"Username",rules:[{required:!0,message:"Please input your Username!"}],children:Object(s.jsx)(m.a,{})}),Object(s.jsx)(b.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(s.jsx)(m.a.Password,{})}),Object(s.jsx)(b.a.Item,{name:"confirm",label:"Confirm Password",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject("The two passwords that you entered do not match!"):Promise.resolve()}}}],children:Object(s.jsx)(m.a.Password,{})}),Object(s.jsx)(b.a.Item,Object(C.a)(Object(C.a)({},N),{},{children:Object(s.jsx)(h.a,{type:"primary",htmlType:"submit",className:"register-btn",children:"Register"})}))]}))},F=a(401),T=a(398),A=a(399),U=a(405),q=m.a.Search;var B=function(e){var t=Object(n.useState)(w),a=Object(c.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)(""),l=Object(c.a)(i,2),d=l[0],u=l[1];return Object(s.jsxs)("div",{className:"search-bar",children:[Object(s.jsx)(q,{placeholder:"input search text",enterButton:"Search",size:"large",onSearch:function(t){r===w||""!==t?(u(""),e.handleSearch({type:r,keyword:t})):u("Please input your search keyword!")},disabled:r===w}),Object(s.jsx)("p",{className:"error-msg",children:d}),Object(s.jsxs)(U.a.Group,{onChange:function(t){var a=t.target.value;o(a),u(""),a===w&&e.handleSearch({type:a,keyword:""})},value:r,className:"search-type-group",children:[Object(s.jsx)(U.a,{value:w,children:"All"}),Object(s.jsx)(U.a,{value:S,children:"Keyword"}),Object(s.jsx)(U.a,{value:P,children:"User"})]})]})},E=a(177),R=a.n(E),z={backgroundColor:"rgba(0, 0, 0, 0.6)",maxHeight:"240px",overflow:"hidden",position:"absolute",bottom:"0",width:"100%",color:"white",padding:"2px",fontSize:"90%"},D={display:"block",minHeight:"1px",width:"100%",border:"1px solid #ddd",overflow:"auto"};var M=function(e){var t=e.images.map((function(e){return Object(C.a)(Object(C.a)({},e),{},{customOverlay:Object(s.jsx)("div",{style:z,children:Object(s.jsx)("div",{children:"".concat(e.user,": ").concat(e.caption)})})})}));return Object(s.jsx)("div",{style:D,children:Object(s.jsx)(R.a,{images:t,enableImageSelection:!1,backdropClosesModal:!0})})},H=a(178),K=a(179),V=a(196),_=a(191),G=a(403),J=a(400),W=a(409),Q=Object(n.forwardRef)((function(e,t){return Object(s.jsxs)(b.a,Object(C.a)(Object(C.a)({name:"validate_other"},{labelCol:{span:6},wrapperCol:{span:14}}),{},{ref:t,children:[Object(s.jsx)(b.a.Item,{name:"description",label:"Message",rules:[{required:!0,message:"Please input your E-mail!"}],children:Object(s.jsx)(m.a,{})}),Object(s.jsx)(b.a.Item,{label:"Dragger",children:Object(s.jsx)(b.a.Item,{name:"uploadPost",valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},noStyle:!0,rules:[{required:!0,message:"Please select an image/video!"}],children:Object(s.jsxs)(J.a.Dragger,{name:"files",beforeUpload:function(){return!1},children:[Object(s.jsx)("p",{className:"ant-upload-drag-icon",children:Object(s.jsx)(W.a,{})}),Object(s.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})})})]}))})),X=function(e){Object(V.a)(a,e);var t=Object(_.a)(a);function a(){var e;Object(H.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={visible:!1,confirmLoading:!1},e.showModal=function(){e.setState({visible:!0})},e.handleOk=function(){e.setState({confirmLoading:!0}),e.postForm.validateFields().then((function(t){var a=t.description,s=t.uploadPost[0],n=s.type,r=s.originFileObj,o=n.match(/^(image|video)/g)[0];if(o){var c=new FormData;c.append("message",a),c.append("media_file",r),console.log(c);var i={method:"POST",url:"".concat(y,"/upload"),headers:{Authorization:"Bearer ".concat(localStorage.getItem(v))},data:c};x()(i).then((function(t){200===t.status&&(j.b.success("The image/video is uploaded!"),e.postForm.resetFields(),e.handleCancel(),e.props.onShowPost(o),e.setState({confirmLoading:!1}))})).catch((function(t){console.log("Upload image/video failed: ",t.message),j.b.error("Failed to upload image/video!"),e.setState({confirmLoading:!1})}))}})).catch((function(e){console.log("err ir validate form -> ",e)}))},e.handleCancel=function(){console.log("Clicked cancel button"),e.setState({visible:!1})},e}return Object(K.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.confirmLoading;return Object(s.jsxs)("div",{children:[Object(s.jsx)(h.a,{type:"primary",onClick:this.showModal,children:"Create New Post"}),Object(s.jsx)(G.a,{title:"Create New Post",visible:a,onOk:this.handleOk,okText:"Create",confirmLoading:n,onCancel:this.handleCancel,children:Object(s.jsx)(Q,{ref:function(t){return e.postForm=t}})})]})}}]),a}(n.Component),Y=F.a.TabPane;var Z=function(e){var t=Object(n.useState)([]),a=Object(c.a)(t,2),r=a[0],o=a[1],i=Object(n.useState)("image"),l=Object(c.a)(i,2),d=l[0],u=l[1],b=Object(n.useState)({type:w,keyword:""}),m=Object(c.a)(b,2),h=m[0],p=m[1];Object(n.useEffect)((function(){h.type,h.keyword;g(h)}),[h]);var g=function(e){var t=e.type,a=e.keyword,s={method:"GET",url:t===w?"".concat(y,"/search"):t===P?"".concat(y,"/search?user=").concat(a):"".concat(y,"/search?keywords=").concat(a),headers:{Authorization:"Bearer ".concat(localStorage.getItem(v))}};x()(s).then((function(e){200===e.status&&(console.log(e.data),o(e.data))})).catch((function(e){j.b.error("Fetch posts failed!"),console.log("fetch posts failed: ",e.message)}))},O=function(e){if(!r||0===r.length)return Object(s.jsx)("div",{children:"No data!"});if("image"===e){var t=r.filter((function(e){return"image"===e.type})).map((function(e){return{src:e.url,user:e.user,caption:e.message,thumbnail:e.url,thumbnailWidth:300,thumbnailHeight:200}}));return Object(s.jsx)(M,{images:t})}return"video"===e?Object(s.jsx)(T.a,{gutter:32,children:r.filter((function(e){return"video"===e.type})).map((function(e){return Object(s.jsxs)(A.a,{span:8,children:[Object(s.jsx)("video",{src:e.url,controls:!0,className:"video-block"}),Object(s.jsxs)("p",{children:[e.user,": ",e.message]})]},e.url)}))}):void 0},f=Object(s.jsx)(X,{onShowPost:function(e){console.log("type -> ",e),u(e),setTimeout((function(){p({type:w,keyword:""})}),3e3)}});return Object(s.jsxs)("div",{className:"home",children:[Object(s.jsx)(B,{handleSearch:function(e){var t=e.type,a=e.keyword;p({type:t,keyword:a})}}),Object(s.jsx)("div",{className:"display",children:Object(s.jsxs)(F.a,{onChange:function(e){return u(e)},defaultActiveKey:"image",activeKey:d,tabBarExtraContent:f,children:[Object(s.jsx)(Y,{tab:"Images",children:O("image")},"image"),Object(s.jsx)(Y,{tab:"Videos",children:O("video")},"video")]})})]})};var $=function(e){var t=e.handleLoggedIn,a=e.isLoggedIn,n=function(){return a?Object(s.jsx)(u.a,{to:"/home"}):Object(s.jsx)(k,{handleLoggedIn:t})};return Object(s.jsx)("div",{className:"main",children:Object(s.jsxs)(u.d,{children:[Object(s.jsx)(u.b,{path:"/",exact:!0,render:n}),Object(s.jsx)(u.b,{path:"/login",render:n}),Object(s.jsx)(u.b,{path:"/register",component:L}),Object(s.jsx)(u.b,{path:"/home",render:function(){return a?Object(s.jsx)(Z,{}):Object(s.jsx)(u.a,{to:"/login"})}})]})})};var ee=function(){var e=Object(n.useState)(!!localStorage.getItem(v)),t=Object(c.a)(e,2),a=t[0],r=t[1];return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)(d,{isLoggedIn:a,handleLogout:function(){console.log("log out"),localStorage.removeItem(v),r(!1)}}),Object(s.jsx)($,{handleLoggedIn:function(e){e&&(localStorage.setItem(v,e),r(!0))},isLoggedIn:a})]})},te=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,410)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,o=t.getTTFB;a(e),s(e),n(e),r(e),o(e)}))};o.a.render(Object(s.jsx)(O.a,{children:Object(s.jsx)(ee,{})}),document.getElementById("root")),te()}},[[396,1,2]]]);
//# sourceMappingURL=main.a594e085.chunk.js.map